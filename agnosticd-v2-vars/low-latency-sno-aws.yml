---
# ===================================================================
# Low-Latency Performance Workshop - SNO Deployment
# Pure AgnosticD V2 Best Practices
# ===================================================================

# ===================================================================
# Mandatory Variables (agnosticd-v2)
# ===================================================================
cloud_provider: aws
cloud_provider_version: main
config: openshift-cluster

# ===================================================================
# Collections (agnosticd-v2 best practice)
# ===================================================================
requirements_content:
  collections:
  - name: https://github.com/agnosticd/core_workloads.git
    type: git
    version: main

# ===================================================================
# AWS Configuration
# ===================================================================
aws_region: us-east-2

cloud_tags:
  - owner: user@example.com
  - Purpose: low-latency-workshop
  - config: openshift-cluster
  - guid: "{{ guid }}"

# ===================================================================
# SNO Configuration (1 control plane, 0 workers = SNO)
# ===================================================================
control_plane_instance_count: 1
worker_instance_count: 0
control_plane_instance_type: m5.4xlarge
control_plane_storage_size: 200
control_plane_storage_type: gp3

# Installation method
host_ocp4_deploy_installation_method: openshift_install
host_ocp4_installer_version: "4.20"
host_ocp4_installer_set_user_data_kubeadmin_password: true

# ===================================================================
# Bastion Configuration
# ===================================================================
install_bastion: true
bastion_setup_student_user: true
bastion_student_user_name: lab-user

# SSH Keys

# ===================================================================
# Repository Configuration
# ===================================================================
install_satellite_repositories: false
install_rhn_repositories: true

# Required in secrets.yml:
# host_satellite_repositories_hostname:
# host_satellite_repositories_org:
# host_satellite_repositories_activationkey:

# ===================================================================
# Workloads (all from core_workloads collection)
# ===================================================================
workloads:
  # Core operators for workshop
  - agnosticd.core_workloads.ocp4_workload_cert_manager
  - agnosticd.core_workloads.ocp4_workload_openshift_virtualization
  # NOTE: SR-IOV operator workload does not exist in core_workloads collection
  # - agnosticd.core_workloads.ocp4_workload_sriov_network_operator
  # Workshop documentation via Showroom
  - agnosticd.core_workloads.ocp4_workload_showroom

# ===================================================================
# Cert Manager Workload Configuration
# ===================================================================
ocp4_workload_cert_manager_channel: stable-v1
ocp4_workload_cert_manager_aws_region: "{{ aws_region }}"
ocp4_workload_cert_manager_aws_access_key_id: "{{ aws_access_key_id | default('') }}"
ocp4_workload_cert_manager_aws_secret_access_key: "{{ aws_secret_access_key | default('') }}"
# Disable certificate installation since we don't have route53 credentials
ocp4_workload_cert_manager_install_ingress_certificates: false
ocp4_workload_cert_manager_install_api_certificates: false

# ===================================================================
# OpenShift Virtualization Workload Configuration
# ===================================================================
ocp4_workload_openshift_virtualization_channel: stable
ocp4_workload_openshift_virtualization_wait_for_deploy: true

# ===================================================================
# SR-IOV Network Operator Workload Configuration
# ===================================================================
ocp4_workload_sriov_network_operator_channel: stable

# ===================================================================
# Showroom Workload Configuration (Workshop Documentation)
# ===================================================================
# Repository containing Antora content
ocp4_workload_showroom_content_git_repo: https://github.com/tosin2013/low-latency-performance-workshop.git
ocp4_workload_showroom_content_git_repo_ref: main

# Antora content location in repository
ocp4_workload_showroom_content_path: content

# Showroom configuration
ocp4_workload_showroom_namespace: low-latency-workshop
ocp4_workload_showroom_name: workshop-docs

# Workshop-specific attributes (passed to Antora)
ocp4_workload_showroom_antora_attributes:
  guid: "{{ guid }}"
  student_name: "{{ guid }}"
  username: lab-user
  subdomain: "{{ base_domain }}"
  bastion_host: "bastion.{{ guid }}.{{ base_domain }}"
  cluster_api: "https://api.{{ cluster_name }}.{{ base_domain }}:6443"
  cluster_console: "https://console-openshift-console.apps.{{ cluster_name }}.{{ base_domain }}"
  workshop_name: "Low-Latency Performance Workshop"
  openshift_version: "{{ host_ocp4_installer_version }}"

# Showroom UI customization (optional)
ocp4_workload_showroom_lab_name: "Low-Latency Performance Workshop"
ocp4_workload_showroom_ssh_user: lab-user
ocp4_workload_showroom_ssh_password: ""  # Uses SSH key

